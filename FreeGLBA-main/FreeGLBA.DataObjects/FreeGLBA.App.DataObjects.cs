namespace FreeGLBA;

#region FreeGLBA DataObjects
// ============================================================================
// FREEGLBA PROJECT - Generated by Entity Builder Wizard
// Entities: SourceSystem, AccessEvent, DataSubject, ComplianceReport
// Relationships: 1
// ============================================================================

public partial class DataObjects
{
    /// <summary>SourceSystem data transfer object.</summary>
    public class SourceSystem
    {
        /// <summary>Primary key</summary>
        public Guid SourceSystemId { get; set; }
        public string Name { get; set; } = string.Empty;
        public string DisplayName { get; set; } = string.Empty;
        /// <summary>Hashed API key (stored in database)</summary>
        public string ApiKey { get; set; } = string.Empty;
        /// <summary>Plaintext API key - only populated when newly generated. Show to user ONCE then discard.</summary>
        public string? NewApiKey { get; set; }
        public string ContactEmail { get; set; } = string.Empty;
        public bool IsActive { get; set; } = true;
        public DateTime? LastEventReceivedAt { get; set; }
        public long EventCount { get; set; } = 0;
    }

    /// <summary>Filter criteria for SourceSystemQueries.</summary>
    public class SourceSystemFilter
    {
        public string? Search { get; set; }
        public string SortColumn { get; set; } = "SourceSystemId";
        public bool SortDescending { get; set; } = true;
        public int Page { get; set; } = 1;
        public int PageSize { get; set; } = 25;
        public int Skip => (Page - 1) * PageSize;
        public bool? IsActiveFilter { get; set; }
        // Advanced filters
        public long? MinEventCount { get; set; }
        public long? MaxEventCount { get; set; }
        public DateTime? LastActivityAfter { get; set; }
        public DateTime? LastActivityBefore { get; set; }
    }

    /// <summary>Paginated result for SourceSystem queries.</summary>
    public class SourceSystemFilterResult
    {
        public List<SourceSystem> Records { get; set; } = new();
        public int TotalRecords { get; set; }
        public int Page { get; set; }
        public int PageSize { get; set; }
        public int TotalPages => (int)Math.Ceiling((double)TotalRecords / PageSize);
    }


    /// <summary>AccessEvent data transfer object.</summary>
    public class AccessEvent
    {
        /// <summary>Primary key</summary>
        public Guid AccessEventId { get; set; }
        public Guid SourceSystemId { get; set; }
        /// <summary>Dedupe key from source</summary>
        public string SourceEventId { get; set; } = string.Empty;
        public DateTime AccessedAt { get; set; }
        public DateTime ReceivedAt { get; set; }
        public string UserId { get; set; } = string.Empty;
        public string UserName { get; set; } = string.Empty;
        public string UserEmail { get; set; } = string.Empty;
        public string UserDepartment { get; set; } = string.Empty;
        /// <summary>Primary subject ID (for single-subject access) or "BULK" for multi-subject.</summary>
        public string SubjectId { get; set; } = string.Empty;
        public string SubjectType { get; set; } = string.Empty;
        /// <summary>JSON array of all subject IDs for bulk access (e.g., CSV exports).</summary>
        public string SubjectIds { get; set; } = string.Empty;
        /// <summary>Count of subjects accessed. 1 for single, N for bulk exports.</summary>
        public int SubjectCount { get; set; } = 1;
        public string DataCategory { get; set; } = string.Empty;
        public string AccessType { get; set; } = string.Empty;
        public string Purpose { get; set; } = string.Empty;
        public string IpAddress { get; set; } = string.Empty;
        /// <summary>JSON for flexible extras</summary>
        public string AdditionalData { get; set; } = string.Empty;
        /// <summary>Display name for related SourceSystem.</summary>
        public string SourceSystemName { get; set; } = string.Empty;
        /// <summary>Copy of the privacy notice/agreement text shown to user at time of access.</summary>
        public string AgreementText { get; set; } = string.Empty;
        /// <summary>When the user acknowledged the privacy agreement.</summary>
        public DateTime? AgreementAcknowledgedAt { get; set; }
    }

    /// <summary>Filter criteria for AccessEvent queries.</summary>
    public class AccessEventFilter
    {
        public string? Search { get; set; }
        public string SortColumn { get; set; } = "AccessEventId";
        public bool SortDescending { get; set; } = true;
        public int Page { get; set; } = 1;
        public int PageSize { get; set; } = 25;
        public int Skip => (Page - 1) * PageSize;
        public Guid SourceSystemIdFilter { get; set; }
        public (DateTime? Start, DateTime? End)? AccessedAtFilter { get; set; }
        public (DateTime? Start, DateTime? End)? ReceivedAtFilter { get; set; }
        // Advanced filters (friendly property names)
        public DateTime? AccessedAfter { get; set; }
        public DateTime? AccessedBefore { get; set; }
        public string? UserIdFilter { get; set; }
        public string? SubjectIdFilter { get; set; }
        public string? AccessTypeFilter { get; set; }
        public string? DataCategoryFilter { get; set; }
        public string? DepartmentFilter { get; set; }
    }

    /// <summary>Paginated result for AccessEvent queries.</summary>
    public class AccessEventFilterResult
    {
        public List<AccessEvent> Records { get; set; } = new();
        public int TotalRecords { get; set; }
        public int Page { get; set; }
        public int PageSize { get; set; }
        public int TotalPages => (int)Math.Ceiling((double)TotalRecords / PageSize);
    }


    /// <summary>DataSubject data transfer object.</summary>
    public class DataSubject
    {
        /// <summary>Primary key</summary>
        public Guid DataSubjectId { get; set; }
        public string ExternalId { get; set; } = string.Empty;
        public string SubjectType { get; set; } = string.Empty;
        public DateTime FirstAccessedAt { get; set; }
        public DateTime LastAccessedAt { get; set; }
        public long TotalAccessCount { get; set; } = 0;
        public int UniqueAccessorCount { get; set; } = 0;
    }

    /// <summary>Filter criteria for DataSubject queries.</summary>
    public class DataSubjectFilter
    {
        public string? Search { get; set; }
        public string SortColumn { get; set; } = "DataSubjectId";
        public bool SortDescending { get; set; } = true;
        public int Page { get; set; } = 1;
        public int PageSize { get; set; } = 25;
        public int Skip => (Page - 1) * PageSize;
        public (DateTime? Start, DateTime? End)? FirstAccessedAtFilter { get; set; }
        public (DateTime? Start, DateTime? End)? LastAccessedAtFilter { get; set; }
        public (decimal? Min, decimal? Max)? UniqueAccessorCountFilter { get; set; }
        // Advanced filters (friendly property names)
        public string? SubjectTypeFilter { get; set; }
        public long? MinTotalAccesses { get; set; }
        public long? MaxTotalAccesses { get; set; }
        public int? MinUniqueAccessors { get; set; }
        public int? MaxUniqueAccessors { get; set; }
        public DateTime? LastAccessAfter { get; set; }
        public DateTime? LastAccessBefore { get; set; }
        public DateTime? FirstAccessAfter { get; set; }
        public DateTime? FirstAccessBefore { get; set; }
    }

    /// <summary>Paginated result for DataSubject queries.</summary>
    public class DataSubjectFilterResult
    {
        public List<DataSubject> Records { get; set; } = new();
        public int TotalRecords { get; set; }
        public int Page { get; set; }
        public int PageSize { get; set; }
        public int TotalPages => (int)Math.Ceiling((double)TotalRecords / PageSize);
    }


    /// <summary>ComplianceReport data transfer object.</summary>
    public class ComplianceReport
    {
        /// <summary>Primary key</summary>
        public Guid ComplianceReportId { get; set; }
        public string ReportType { get; set; } = string.Empty;
        public DateTime GeneratedAt { get; set; }
        public string GeneratedBy { get; set; } = string.Empty;
        public DateTime PeriodStart { get; set; }
        public DateTime PeriodEnd { get; set; }
        public long TotalEvents { get; set; } = 0;
        public int UniqueUsers { get; set; } = 0;
        public int UniqueSubjects { get; set; } = 0;
        /// <summary>JSON report content</summary>
        public string ReportData { get; set; } = string.Empty;
        public string FileUrl { get; set; } = string.Empty;
    }

    /// <summary>Filter criteria for ComplianceReport queries.</summary>
    public class ComplianceReportFilter
    {
        public string? Search { get; set; }
        public string SortColumn { get; set; } = "ComplianceReportId";
        public bool SortDescending { get; set; } = true;
        public int Page { get; set; } = 1;
        public int PageSize { get; set; } = 25;
        public int Skip => (Page - 1) * PageSize;
        public (DateTime? Start, DateTime? End)? GeneratedAtFilter { get; set; }
        public (DateTime? Start, DateTime? End)? PeriodStartFilter { get; set; }
        public (DateTime? Start, DateTime? End)? PeriodEndFilter { get; set; }
        public (decimal? Min, decimal? Max)? UniqueUsersFilter { get; set; }
        public (decimal? Min, decimal? Max)? UniqueSubjectsFilter { get; set; }
        // Advanced filters (friendly property names)
        public string? ReportTypeFilter { get; set; }
        public DateTime? GeneratedAfter { get; set; }
        public DateTime? GeneratedBefore { get; set; }
        public long? MinTotalEvents { get; set; }
        public long? MaxTotalEvents { get; set; }
        public int? MinUniqueUsers { get; set; }
        public int? MaxUniqueUsers { get; set; }
        public int? MinUniqueSubjects { get; set; }
        public int? MaxUniqueSubjects { get; set; }
    }

    /// <summary>Paginated result for ComplianceReport queries.</summary>
    public class ComplianceReportFilterResult
    {
        public List<ComplianceReport> Records { get; set; } = new();
        public int TotalRecords { get; set; }
        public int Page { get; set; }
        public int PageSize { get; set; }
        public int TotalPages => (int)Math.Ceiling((double)TotalRecords / PageSize);
    }


    /// <summary>Lookup DTO for SourceSystem dropdowns.</summary>
    public class SourceSystemLookup
    {
        public Guid SourceSystemId { get; set; }
        public string DisplayName { get; set; } = string.Empty;
    }

    /// <summary>Lookup DTO for AccessEvent dropdowns.</summary>
    public class AccessEventLookup
    {
        public Guid AccessEventId { get; set; }
        public string DisplayName { get; set; } = string.Empty;
    }

    /// <summary>Lookup DTO for DataSubject dropdowns.</summary>
    public class DataSubjectLookup
    {
        public Guid DataSubjectId { get; set; }
        public string DisplayName { get; set; } = string.Empty;
    }

    /// <summary>Lookup DTO for ComplianceReport dropdowns.</summary>
    public class ComplianceReportLookup
    {
        public Guid ComplianceReportId { get; set; }
        public string DisplayName { get; set; } = string.Empty;
    }

}

#endregion
